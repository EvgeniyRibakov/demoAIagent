# üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MCP Google –¥–ª—è Cursor

## ‚úÖ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

1. **MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** –≤ `~/.cursor/mcp.json`:
```json
{
  "mcpServers": {
    "google": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-google"],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "C:\\Users\\User\\Downloads\\demoAIagent-main\\ai-agent-sheets-473515-12c6cb0e6fab.json"
      }
    }
  }
}
```

2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏** –≤ –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. **–¢–µ—Å—Ç–æ–≤—ã–π JSON —Ñ–∞–π–ª** —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1. –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª –æ—Ç Google Cloud Console:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Sheets API –∏ Google Drive API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account:
   - IAM & Admin ‚Üí Service Accounts
   - Create Service Account
   - –ù–∞–∑–≤–∞–Ω–∏–µ: "ai-agent-sheets"
   - Role: "Editor"
5. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á:
   - Keys ‚Üí Add Key ‚Üí Create new key ‚Üí JSON
   - –°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª

### 2. –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π JSON —Ñ–∞–π–ª:

```bash
# –£–¥–∞–ª–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
rm ai-agent-sheets-473515-12c6cb0e6fab.json

# –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
# –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –≤: ai-agent-sheets-473515-12c6cb0e6fab.json
```

### 3. –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª:

```env
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
GOOGLE_APPLICATION_CREDENTIALS=./ai-agent-sheets-473515-12c6cb0e6fab.json

# –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
GOOGLE_SHEETS_ID=18otXyOlqG4FAbLqyZReCwSPkKLGuhEWsVKFNoxctyvQ
GOOGLE_DRIVE_CALLS_FOLDER_ID=your-folder-id
OPENAI_API_KEY=sk-your-real-openai-key-here
```

### 4. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø Service Account –∫ —Ç–∞–±–ª–∏—Ü–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É
2. Share ‚Üí –î–æ–±–∞–≤—å—Ç–µ email –∏–∑ JSON —Ñ–∞–π–ª–∞ (client_email)
3. –ü—Ä–∞–≤–∞: Editor

### 5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MCP Google —Å–µ—Ä–≤–µ—Ä:

```bash
# –ß–µ—Ä–µ–∑ npm (–≥–ª–æ–±–∞–ª—å–Ω–æ)
npm install -g @modelcontextprotocol/server-google

# –ò–ª–∏ —á–µ—Ä–µ–∑ npx (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
# –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ mcp.json
```

### 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Cursor

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Cursor –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

### –í Cursor –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:
```
–ü–æ–∫–∞–∂–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–æ–µ–π Google –¢–∞–±–ª–∏—Ü–µ
–ü—Ä–æ—á–∏—Ç–∞–π –ª–∏—Å—Ç Algorithm –∏–∑ Google Sheets
–ù–∞–π–¥–∏ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ Calls –≤ Google Drive
```

### –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª:
```bash
# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
poetry run python src/ai_agent/setup/test_connections.py

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets
poetry run python src/ai_agent/setup/google_setup.py
```

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. ‚úÖ **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏** - –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ JSON** - –∫–æ–¥ —Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª—ã credentials
3. ‚úÖ **MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è Cursor
4. ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Python** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:

- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –†–ê–ë–û–¢–ê–ï–¢
- ‚ùå **Google Auth**: –ù—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª
- ‚ùå **Google Sheets**: –ù—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª  
- ‚úÖ **Google Drive**: –†–ê–ë–û–¢–ê–ï–¢
- ‚ùå **OpenAI API**: –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ–≥–∏–æ–Ω–æ–º (403 –æ—à–∏–±–∫–∞)

## üéâ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

Cursor —Å–º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å Google Sheets:
- –ß–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü
- –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã

---

**–ì–æ—Ç–æ–≤–æ! –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π JSON —Ñ–∞–π–ª –æ—Ç Google Cloud Console!** üöÄ
