# üîó –ì–∞–π–¥: –°–≤—è–∑–∫–∞ Google –¢–∞–±–ª–∏—Ü –∏ Cursor

## üéØ –ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–≤—è–∑–∫—É –º–µ–∂–¥—É Cursor (Node.js) –∏ Google –¢–∞–±–ª–∏—Ü–∞–º–∏ —á–µ—Ä–µ–∑ Google Sheets API, —á—Ç–æ–±—ã –∞–≥–µ–Ω—Ç –º–æ–≥ —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Google Cloud Project

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Google Cloud Console**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://console.cloud.google.com/
   - –í–æ–π–¥–∏—Ç–µ –≤ Google –∞–∫–∫–∞—É–Ω—Ç

2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç**
   - –ù–∞–∂–º–∏—Ç–µ "Select a project" ‚Üí "New Project"
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `ai-agent-sheets` (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ)
   - –ù–∞–∂–º–∏—Ç–µ "Create"

3. **–í–∫–ª—é—á–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ API**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: APIs & Services ‚Üí Library
   - –ù–∞–π–¥–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ:
     - **Google Sheets API** ‚Üí Enable
     - **Google Drive API** ‚Üí Enable

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. **–°–æ–∑–¥–∞–π—Ç–µ Service Account**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: IAM & Admin ‚Üí Service Accounts
   - –ù–∞–∂–º–∏—Ç–µ "Create Service Account"
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `ai-agent-sheets`
   - –û–ø–∏—Å–∞–Ω–∏–µ: `Service account for AI Agent automation`
   - –ù–∞–∂–º–∏—Ç–µ "Create and Continue"

2. **–ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª–∏**
   - Role: `Editor` (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—É—é —Ä–æ–ª—å)
   - –ù–∞–∂–º–∏—Ç–µ "Continue" ‚Üí "Done"

3. **–°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á**
   - –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: Keys ‚Üí Add Key ‚Üí Create new key
   - –í—ã–±–µ—Ä–∏—Ç–µ: JSON
   - –ù–∞–∂–º–∏—Ç–µ "Create"
   - **–°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª** (–æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª**
   ```bash
   cp .env.example .env
   ```

2. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env –∏–∑ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ JSON**
   ```env
   # –ò–∑ JSON —Ñ–∞–π–ª–∞
   GOOGLE_PROJECT_ID=your-project-id
   GOOGLE_CLIENT_EMAIL=ai-agent-sheets@your-project.iam.gserviceaccount.com
   GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
   
   # ID –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü—ã (–∏–∑ URL)
   GOOGLE_SHEETS_ID=18otXyOlqG4FAbLqyZReCwSPkKLGuhEWsVKFNoxctyvQ
   
   # ID –ø–∞–ø–∫–∏ –≤ Google Drive –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ (—Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–∑–∂–µ)
   GOOGLE_DRIVE_CALLS_FOLDER_ID=
   
   # OpenAI API –∫–ª—é—á –¥–ª—è LLM
   OPENAI_API_KEY=sk-...
   ```

3. **–í–∞–∂–Ω–æ –¥–ª—è GOOGLE_PRIVATE_KEY**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ private_key –∏–∑ JSON
   - –û–±–µ—Ä–Ω–∏—Ç–µ –≤ –∫–∞–≤—ã—á–∫–∏
   - –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ `\n` –Ω–∞ `\\n`
   - –ü—Ä–∏–º–µ—Ä:
   ```env
   GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\\n-----END PRIVATE KEY-----\\n"
   ```

### –®–∞–≥ 4: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É Google –¢–∞–±–ª–∏—Ü—É**
   - https://docs.google.com/spreadsheets/d/18otXyOlqG4FAbLqyZReCwSPkKLGuhEWsVKFNoxctyvQ/edit

2. **–î–æ–±–∞–≤—å—Ç–µ Service Account**
   - –ù–∞–∂–º–∏—Ç–µ "Share" (–ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª)
   - –î–æ–±–∞–≤—å—Ç–µ email –∏–∑ `GOOGLE_CLIENT_EMAIL`
   - –ü—Ä–∞–≤–∞: **Editor**
   - –ù–∞–∂–º–∏—Ç–µ "Send"

### –®–∞–≥ 5: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   ```bash
   poetry install
   # –∏–ª–∏
   pip install -r requirements.txt
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É**
   ```bash
   poetry run python src/ai_agent/setup/google_setup.py
   # –∏–ª–∏
   python src/ai_agent/setup/google_setup.py
   ```

   –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ
   - –°–æ–∑–¥–∞—Å—Ç –ª–∏—Å—Ç—ã: Algorithm, Signals, Decisions, Proposals
   - –î–æ–±–∞–≤–∏—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏
   - –í—Å—Ç–∞–≤–∏—Ç 6 —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª

### –®–∞–≥ 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Apps Script

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Google –¢–∞–±–ª–∏—Ü—É**
2. **Extensions ‚Üí Apps Script**
3. **–£–¥–∞–ª–∏—Ç–µ –≤–µ—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥**
4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞**
   - –û—Ç–∫—Ä–æ–π—Ç–µ: `src/apps-script/enhanced-agent.gs`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥
   - –í—Å—Ç–∞–≤—å—Ç–µ –≤ Apps Script
5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** (Ctrl+S)
6. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É**
7. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (F5)
8. **–ü–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é "ü§ñ AI Agent"**

### –®–∞–≥ 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ö–µ–º—É**
   - ü§ñ AI Agent ‚Üí üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ö–µ–º—ã

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - ü§ñ AI Agent ‚Üí üìä –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã

3. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
   - ü§ñ AI Agent ‚Üí üìã –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üîß –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
npm run setup:all

# –¢–æ–ª—å–∫–æ Google Sheets
npm run setup:google

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤
npm run proposals:from-drive

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "PERMISSION_DENIED"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Service Account –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–∞–∫ "Editor"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å GOOGLE_SHEETS_ID

### –û—à–∏–±–∫–∞ "Invalid credentials"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç GOOGLE_PRIVATE_KEY (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å \\n)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ JSON –∫–ª—é—á –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ GOOGLE_CLIENT_EMAIL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### –û—à–∏–±–∫–∞ "Spreadsheet not found"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GOOGLE_SHEETS_ID –≤ .env
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω–∞

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:
- –õ–∏—Å—Ç **Algorithm** —Å 6 –ø—Ä–∞–≤–∏–ª–∞–º–∏
- –õ–∏—Å—Ç—ã **Signals**, **Decisions**, **Proposals** —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- –ú–µ–Ω—é **ü§ñ AI Agent** –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑–æ–≤—É—é —Å–≤—è–∑–∫—É (—ç—Ç–æ—Ç –≥–∞–π–¥)
2. üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤
3. üìû –ù–∞—Å—Ç—Ä–æ–π—Ç–µ tl;dv ‚Üí Google Drive
4. üöÄ –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –¥–µ–π—Å—Ç–≤–∏—è

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å Cursor –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏. üéâ
